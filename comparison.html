<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DEX åˆçº¦è´¹ç‡å¯¹æ¯” | Hyperliquid vs Ostium</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        /* Cyberpunk Neon Palette */
        --bg-deep: #050510;       /* æ·±ç©ºé»‘ */
        --bg-card: rgba(20, 20, 35, 0.6); /* ç»ç’ƒå¡ç‰‡èƒŒæ™¯ */
        --bg-hover: rgba(40, 40, 60, 0.7);
        
        --glass-border: rgba(255, 255, 255, 0.08);
        --neon-blue: #00f3ff;
        --neon-purple: #9d00ff;
        --neon-green: #00ff9d;
        --neon-red: #ff0055;
        --neon-yellow: #ffee00;
        
        --text-main: #ffffff;
        --text-dim: #8b9bb4;
        
        --glow-blue: 0 0 10px rgba(0, 243, 255, 0.5);
        --glow-purple: 0 0 10px rgba(157, 0, 255, 0.5);
        --glow-green: 0 0 8px rgba(0, 255, 157, 0.4);
        --glow-red: 0 0 8px rgba(255, 0, 85, 0.4);
      }

      * { margin: 0; padding: 0; box-sizing: border-box; }

      body {
        font-family: "Inter", system-ui, sans-serif;
        background-color: var(--bg-deep);
        color: var(--text-main);
        /* åŠ¨æ€ç½‘æ ¼èƒŒæ™¯ */
        background-image: 
          linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
          linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px),
          radial-gradient(circle at 50% 50%, rgba(157, 0, 255, 0.1), transparent 60%);
        background-size: 30px 30px, 30px 30px, 100% 100%;
        min-height: 100vh;
        overflow: hidden;
        font-size: 13px;
      }
      
      /* æ•°å­—å­—ä½“ (åƒç´ é£æ ¼æˆ–æœºæ¢°é£æ ¼æ¨è) */
      .price-value, .stat-value, .comp-value {
        font-family: "JetBrains Mono", monospace;
        letter-spacing: -0.5px;
      }

      /* ================= å¤´éƒ¨ ================= */
      .header {
        height: 48px; /* å‡å°å¤´éƒ¨é«˜åº¦ */
        padding: 0 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(5, 5, 16, 0.8);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--glass-border);
        box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        position: relative;
        z-index: 100;
      }
      
      /* åº•éƒ¨æµå…‰çº¿æ¡ */
      .header::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--neon-blue), var(--neon-purple), transparent);
        opacity: 0.7;
      }

      .logo {
        font-size: 1.1rem; /* ç•¥å¾®è°ƒå° */
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        background: linear-gradient(135deg, #fff, var(--neon-blue));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .update-time {
        font-family: monospace;
        color: var(--neon-blue);
        border: 1px solid rgba(0, 243, 255, 0.3);
        padding: 0.1rem 0.5rem;
        font-size: 0.75rem; /* è°ƒå°å­—ä½“ */
        border-radius: 4px;
        background: rgba(0, 243, 255, 0.05);
        box-shadow: 0 0 10px rgba(0, 243, 255, 0.1);
      }

      /* ================= ä¸»å¸ƒå±€ ================= */
      .container {
        height: calc(100vh - 48px);
        padding: 0.5rem; /* å‡å°å®¹å™¨å†…è¾¹è· */
      }

      .columns {
        display: grid;
        grid-template-columns: 1fr 1.2fr 1fr;
        gap: 0.5rem; /* å‡å°åˆ—é—´è· */
        height: 100%;
      }

      /* åˆ—å®¹å™¨ - ç»ç’ƒæ‹Ÿæ€ */
      .column {
        background: rgba(10, 10, 25, 0.4);
        border: 1px solid var(--glass-border);
        border-radius: 8px; /* å‡å°åœ†è§’ */
        backdrop-filter: blur(5px);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        position: relative;
      }
      
      /* åˆ—é¡¶éƒ¨å‘å…‰ */
      .column::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      }

      /* åˆ—æ ‡é¢˜ */
      .column-header {
        padding: 0.5rem 0.8rem; /* å‡å°æ ‡é¢˜æ å†…è¾¹è· */
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(0, 0, 0, 0.2);
        height: 40px; /* å›ºå®šæ›´å°çš„é«˜åº¦ */
      }

      /* æœç´¢æ æ ·å¼ */
      .search-bar {
        padding: 0.4rem 0.5rem;
        background: rgba(0, 0, 0, 0.1);
        border-bottom: 1px solid var(--glass-border);
      }
      
      .search-input {
        width: 100%;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        padding: 0.3rem 0.5rem;
        color: var(--text-main);
        font-family: inherit;
        font-size: 0.8rem;
        outline: none;
        transition: all 0.2s;
      }
      
      .search-input:focus {
        background: rgba(255, 255, 255, 0.08);
        border-color: var(--neon-blue);
        box-shadow: 0 0 5px rgba(0, 243, 255, 0.2);
      }
      
      .search-input::placeholder {
        color: rgba(255, 255, 255, 0.3);
      }

      .column-title {
        font-size: 0.85rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--text-dim);
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      
      /* å“ç‰Œè‰²åœ†ç‚¹ */
      .dot { width: 6px; height: 6px; border-radius: 50%; box-shadow: 0 0 6px currentColor; }
      .hl-dot { color: var(--neon-blue); }
      .os-dot { color: var(--neon-green); }
      .com-dot { color: var(--neon-purple); }

      .column-count {
        font-size: 0.65rem;
        color: rgba(255,255,255,0.5);
        background: rgba(255,255,255,0.05);
        padding: 0.1rem 0.4rem;
        border-radius: 8px;
      }

      .column-body {
        flex: 1;
        overflow-y: auto;
        padding: 0.5rem; /* å‡å°å†…å®¹åŒºå†…è¾¹è· */
        scrollbar-width: thin;
        scrollbar-color: rgba(255,255,255,0.1) transparent;
      }

      /* ================= å¡ç‰‡æ ·å¼ (æ ¸å¿ƒç‚«é…·ç‚¹) ================= */
      .contract-card, .comparison-card {
        background: var(--bg-card);
        border: 1px solid var(--glass-border);
        border-radius: 6px;
        padding: 0.5rem; /* æåº¦ç´§å‡‘ */
        margin-bottom: 0.5rem; /* å‡å°å¡ç‰‡é—´è· */
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      /* æ‚¬åœæ•ˆæœï¼šè¾¹æ¡†å‘å…‰ + ä¸Šæµ® */
      .contract-card:hover, .comparison-card:hover {
        background: rgba(30, 30, 50, 0.8);
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      }
      
      /* æ‚¬åœæ—¶çš„éœ“è™¹è¾¹æ¡†æµå…‰ */
      .contract-card:hover::after, .comparison-card:hover::after {
        opacity: 1;
      }
      
      /* éœ“è™¹è¾¹æ¡†ä¼ªå…ƒç´  */
      .contract-card::after, .comparison-card::after {
        content: '';
        position: absolute;
        top: 0; left: 0; width: 2px; height: 100%;
        background: var(--neon-blue);
        box-shadow: 0 0 10px var(--neon-blue);
        opacity: 0;
        transition: opacity 0.3s;
      }
      
      /* Ostium å¡ç‰‡ä¸ºç»¿è‰²æµå…‰ */
      .ostium .contract-card::after { background: var(--neon-green); box-shadow: 0 0 10px var(--neon-green); }
      /* å¯¹æ¯”å¡ç‰‡ä¸ºç´«è‰²æµå…‰ */
      .common .comparison-card::after { background: var(--neon-purple); box-shadow: 0 0 10px var(--neon-purple); }

      /* å¡ç‰‡å†…å®¹å¸ƒå±€ */
      .contract-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.3rem; /* å‡å°æ ‡é¢˜ä¸‹è¾¹è· */
        padding-bottom: 0.3rem;
        border-bottom: 1px dashed rgba(255,255,255,0.05);
      }

      .contract-name {
        font-weight: 700;
        font-size: 0.9rem;
        color: #fff;
        text-shadow: 0 0 10px rgba(255,255,255,0.1);
      }

      .contract-group {
        font-size: 0.55rem;
        padding: 0 0.3rem;
        border-radius: 2px;
        background: rgba(255,255,255,0.05);
        color: var(--text-dim);
        border: 1px solid rgba(255,255,255,0.05);
      }

      .data-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.3rem; /* å‡å°ç½‘æ ¼é—´è· */
      }
      
      .data-item { display: flex; flex-direction: column; }
      
      .data-label {
        font-size: 0.6rem;
        text-transform: uppercase;
        color: rgba(255,255,255,0.4);
        margin-bottom: 1px;
      }
      
      .data-value {
        font-size: 0.85rem;
        font-weight: 500;
      }

      /* é¢œè‰²å®šä¹‰ï¼ˆå¸¦å‘å…‰ï¼‰ */
      .val-pos { color: var(--neon-green); text-shadow: var(--glow-green); }
      .val-neg { color: var(--neon-red); text-shadow: var(--glow-red); }
      .val-neu { color: var(--text-dim); }

      /* å¯¹æ¯”å¡ç‰‡æ ·å¼ */
      .comp-header {
        display: flex;
        justify-content: center;
        margin-bottom: 0.4rem; /* å‡å° */
        position: relative;
        padding-bottom: 0.2rem;
        border-bottom: 1px solid rgba(255,255,255,0.05);
      }
      
      .comp-name {
        font-size: 0.95rem;
        font-weight: 700;
        /* æ”¹ä¸ºæ›´æŸ”å’Œçš„å•è‰²æˆ–ä½å¯¹æ¯”åº¦æ¸å˜ */
        color: var(--text-main);
        background: none;
        -webkit-text-fill-color: initial;
        /* ç§»é™¤å¼ºçƒˆçš„æ–‡å­—å‘å…‰ */
        text-shadow: none;
        opacity: 0.9;
        letter-spacing: 0.5px;
      }
      
      .comp-row {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        margin-bottom: 0.2rem; /* å‡å°è¡Œé—´è· */
        background: rgba(0,0,0,0.2);
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        border: 1px solid transparent;
        transition: border-color 0.2s;
      }
      
      .comp-row:hover { border-color: rgba(255,255,255,0.1); }
      .comp-row:last-child { margin-bottom: 0; }
      
      .comp-cell-left { text-align: left; color: var(--neon-blue); opacity: 0.9; }
      .comp-cell-right { text-align: right; color: var(--neon-green); opacity: 0.9; }
      
      .comp-cell-mid { 
        text-align: center; 
        padding: 0 0.5rem;
        min-width: 80px;
        display: flex;
        justify-content: center;
      }
      
      .diff-tag {
        font-size: 0.8rem;
        padding: 0.1rem 0.6rem;
        border-radius: 10px;
        font-weight: 700;
        min-width: 60px;
        text-align: center;
      }
      
      /* æ­£è´Ÿå·®å€¼æ ·å¼ï¼ˆå¸¦èƒŒæ™¯è¾‰å…‰ï¼‰ */
      .bg-pos { 
        background: rgba(0, 255, 157, 0.1); 
        color: var(--neon-green); 
        border: 1px solid rgba(0, 255, 157, 0.2);
        box-shadow: 0 0 8px rgba(0, 255, 157, 0.1);
      }
      
      .bg-neg { 
        background: rgba(255, 0, 85, 0.1); 
        color: var(--neon-red); 
        border: 1px solid rgba(255, 0, 85, 0.2);
        box-shadow: 0 0 8px rgba(255, 0, 85, 0.1);
      }
      
      /* æ»šåŠ¨æ¡ */
      ::-webkit-scrollbar { width: 4px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 2px; }
      ::-webkit-scrollbar-thumb:hover { background: var(--neon-blue); }
      
      /* å“åº”å¼ */
      @media (max-width: 1200px) {
        .columns { grid-template-columns: 1fr; overflow-y: auto; }
        .column { max-height: none; height: auto; }
        .container { height: auto; overflow-y: auto; }
      }
    </style>
  </head>
  <body>
    <!-- å¤´éƒ¨ -->
    <header class="header">
      <div class="logo">
        <span style="color: var(--neon-blue)">âš¡</span> DEX RATE
        <span style="font-size: 0.8em; opacity: 0.8; font-weight: 400">MONITOR</span>
      </div>
      <div class="update-time" id="updateTime">INITIALIZING SYSTEM...</div>
    </header>

    <div class="container">
      <div class="columns">
        <!-- å·¦æ ï¼šHyperliquid -->
        <div class="column hyperliquid">
          <div class="column-header">
            <div class="column-title">
              <span class="dot hl-dot"></span>
              Hyperliquid
            </div>
            <span class="column-count" id="hlCount">0 ASSETS</span>
          </div>
          <div class="search-bar">
            <input type="text" class="search-input" placeholder="Search Asset..." oninput="filterList(this, 'hlList')">
          </div>
          <div class="column-body" id="hlList"></div>
        </div>

        <!-- ä¸­æ ï¼šå…±åŒåˆçº¦å¯¹æ¯” -->
        <div class="column common">
          <div class="column-header">
            <div class="column-title">
              <span class="dot com-dot"></span>
              ARBITRAGE MONITOR
            </div>
            <span class="column-count" id="commonCount">0 PAIRS</span>
          </div>
          <div class="search-bar">
            <input type="text" class="search-input" placeholder="Search Pair..." oninput="filterList(this, 'commonList')">
          </div>
          <div class="column-body" id="commonList"></div>
        </div>

        <!-- å³æ ï¼šOstium -->
        <div class="column ostium">
          <div class="column-header">
            <div class="column-title">
              <span class="dot os-dot"></span>
              Ostium
            </div>
            <span class="column-count" id="osCount">0 ASSETS</span>
          </div>
          <div class="search-bar">
            <input type="text" class="search-input" placeholder="Search Asset..." oninput="filterList(this, 'osList')">
          </div>
          <div class="column-body" id="osList"></div>
        </div>
      </div>
    </div>

    <script>
      // åç§°æ˜ å°„è¡¨ï¼šOstium åç§° -> Hyperliquid åç§°ï¼ˆä»…åç§°ä¸åŒçš„èµ„äº§éœ€è¦æ˜ å°„ï¼‰
      const NAME_MAPPING = {
        XAU: "GOLD",    // é»„é‡‘
        XAG: "SILVER",  // ç™½é“¶
        HG: "COPPER",   // é“œ
        NDX: "XYZ100",  // çº³æ–¯è¾¾å…‹100æŒ‡æ•°
      };

      // åå‘æ˜ å°„
      const REVERSE_MAPPING = {};
      for (const [os, hl] of Object.entries(NAME_MAPPING)) {
        REVERSE_MAPPING[hl] = os;
      }

      // æ ¼å¼åŒ–ä»·æ ¼
      function formatPrice(price) {
        if (!price && price !== 0) return "N/A";
        const num = parseFloat(price);
        if (num >= 1000)
          return num.toLocaleString("en-US", { maximumFractionDigits: 2 });
        if (num >= 1) return num.toFixed(4);
        return num.toFixed(6);
      }

      // æ ¼å¼åŒ–è´¹ç‡
      function formatRate(rate) {
        if (!rate && rate !== 0) return "N/A";
        const num = parseFloat(rate);
        return (num >= 0 ? "+" : "") + num.toFixed(4) + "%";
      }

      // æ ¼å¼åŒ–æˆäº¤é‡
      function formatVolume(vol) {
        if (!vol && vol !== 0) return "N/A";
        const num = parseFloat(vol);
        if (num >= 1e9) return "$" + (num / 1e9).toFixed(2) + "B";
        if (num >= 1e6) return "$" + (num / 1e6).toFixed(2) + "M";
        if (num >= 1e3) return "$" + (num / 1e3).toFixed(2) + "K";
        return "$" + num.toFixed(0);
      }

      // è·å–åˆ†ç»„é¢œè‰²ç±»ï¼ˆç²¾ç®€ï¼‰
      function getGroupClass(group) {
        return "contract-group";
      }

      // åˆ—è¡¨è¿‡æ»¤å‡½æ•°
      function filterList(input, listId) {
        const query = input.value.trim().toLowerCase();
        const list = document.getElementById(listId);
        // æ ¹æ®åˆ—è¡¨IDé€‰æ‹©å¡ç‰‡ç±»å
        const cardClass = listId === 'commonList' ? 'comparison-card' : 'contract-card';
        const cards = list.getElementsByClassName(cardClass);
        
        // éå†æ‰€æœ‰å¡ç‰‡
        for (let i = 0; i < cards.length; i++) {
          const card = cards[i];
          // ç®€å•ç²—æš´ï¼šæœç´¢åªè¦å‡ºç°åœ¨å¡ç‰‡æ–‡æœ¬å†…å®¹é‡Œå°±ç®—åŒ¹é…
          // ä¹Ÿå¯ä»¥ç²¾ç»†åŒ–ï¼šåªæœæ ‡é¢˜ card.querySelector('.contract-name').textContent
          const text = card.textContent.toLowerCase();
          
          if (text.includes(query)) {
            card.style.display = "";
          } else {
            card.style.display = "none";
          }
        }
      }

      // æ ¹æ®æ•°å€¼è¿”å›é¢œè‰²ç±»
      function getValClass(val) {
        if (!val && val !== 0) return "val-neu";
        return val > 0 ? "val-pos" : val < 0 ? "val-neg" : "val-neu";
      }

      // æ¸²æŸ“ Hyperliquid åˆçº¦å¡ç‰‡ (ç´§å‡‘ç‰ˆ)
      function renderHLCard(contract) {
        const fundingHourly = contract.fundingRate?.rateHourly;
        const rateClass = getValClass(fundingHourly);

        return `
                <div class="contract-card">
                    <div class="contract-header">
                        <span class="contract-name">${contract.coin}</span>
                        <span class="contract-group">PERP</span>
                    </div>
                    
                    <div class="data-grid">
                        <div class="data-item">
                            <span class="data-label">Price</span>
                            <span class="data-value">$${formatPrice(contract.mid)}</span>
                        </div>
                        <div class="data-item" style="align-items: flex-end;">
                            <span class="data-label">1h Rate</span>
                            <span class="data-value ${rateClass}">${formatRate(fundingHourly)}</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">24h Vol</span>
                            <span class="data-value">${formatVolume(contract.dayVolume_USD)}</span>
                        </div>
                        <div class="data-item" style="align-items: flex-end;">
                            <span class="data-label">OI</span>
                            <span class="data-value">${contract.openInterest ? parseFloat(contract.openInterest).toFixed(0) : 'N/A'}</span>
                        </div>
                    </div>
                </div>
            `;
      }

      // æ¸²æŸ“ Ostium åˆçº¦å¡ç‰‡ (ç´§å‡‘ç‰ˆ)
      function renderOSCard(contract) {
        const hasFunding = contract.fundingRate?.longPayHourly;
        const rate = hasFunding
          ? contract.fundingRate.longPayHourly
          : contract.rolloverRate?.hourly;
        const rateLabel = hasFunding ? "Fund/h" : "Roll/h";
        const rateClass = getValClass(hasFunding ? rate : -rate); // èµ„é‡‘è´¹ç‡æ­£å€¼ä»˜é’±(è´Ÿé¢)ï¼Œéš”å¤œè´¹é€šå¸¸æ˜¯è´Ÿé¢

        return `
                <div class="contract-card">
                    <div class="contract-header">
                        <span class="contract-name">${contract.pair}</span>
                        <span class="contract-group">${contract.group || "N/A"}</span>
                    </div>
                    
                    <div class="data-grid">
                        <div class="data-item">
                            <span class="data-label">Price</span>
                            <span class="data-value">$${formatPrice(contract.mid)}</span>
                        </div>
                        <div class="data-item" style="align-items: flex-end;">
                            <span class="data-label">${rateLabel}</span>
                            <span class="data-value ${rateClass}">${formatRate(rate)}</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Total OI</span>
                            <span class="data-value">${formatVolume(contract.totalOI_USD)}</span>
                        </div>
                        <div class="data-item" style="align-items: flex-end;">
                            <span class="data-label">Type</span>
                            <span class="data-value" style="font-size: 0.8rem; color: var(--text-overlay)">${contract.group}</span>
                        </div>
                    </div>
                </div>
            `;
      }

      // æ¸²æŸ“å…±åŒåˆçº¦å¯¹æ¯”å¡ç‰‡ (é«˜å¯†åº¦ç‰ˆ)
      function renderComparisonCard(hlContract, osContract, commonName) {
        const hlFunding = hlContract.fundingRate?.rateHourly;
        // Ostium: èµ„é‡‘è´¹ç‡(æ­£=å¤šå¤´ä»˜ç©ºå¤´) æˆ– éš”å¤œè´¹
        const osFunding =
          osContract.fundingRate?.longPayHourly ||
          osContract.rolloverRate?.hourly;
          
        const priceDiff =
          ((hlContract.mid - osContract.mid) / osContract.mid) * 100;
        const rateDiff = hlFunding && osFunding ? hlFunding - osFunding : null;

        // å·®ä»·å¾½ç« é¢œè‰²
        const priceDiffClass = priceDiff >= 0 ? "bg-pos" : "bg-neg";
        const rateDiffClass = rateDiff >= 0 ? "bg-neg" : "bg-pos"; // è´¹ç‡å·®è¶Šå¤§é€šå¸¸æ„å‘³ç€å¥—åˆ©ç©ºé—´ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯æˆæœ¬

        return `
                <div class="comparison-card">
                    <div class="comp-header">
                        <span class="comp-name">${commonName}</span>
                    </div>
                    
                    <!-- ä»·æ ¼è¡Œ -->
                    <div class="comp-row">
                        <span class="comp-cell-left">$${formatPrice(hlContract.mid)}</span>
                        <div class="comp-cell-mid">
                            <span class="diff-tag ${priceDiffClass}">
                                ${priceDiff >= 0 ? "+" : ""}${priceDiff.toFixed(3)}%
                            </span>
                        </div>
                        <span class="comp-cell-right">$${formatPrice(osContract.mid)}</span>
                    </div>
                    
                    <!-- è´¹ç‡è¡Œ -->
                    <div class="comp-row">
                        <span class="comp-cell-left comp-val-hl">${formatRate(hlFunding)}</span>
                        <div class="comp-cell-mid">
                            <span style="opacity: 0.5">Rate Î”</span>
                        </div>
                        <span class="comp-cell-right comp-val-os">${formatRate(osFunding)}</span>
                    </div>
                    
                    <!-- è´¹ç‡å·®å€¼è¡Œ (å¦‚æœæœ‰) -->
                    ${rateDiff !== null ? `
                    <div class="comp-row">
                        <span class="comp-cell-left" style="font-size: 0.75rem; color: var(--text-overlay)">Vol: ${formatVolume(hlContract.dayVolume_USD)}</span>
                        <div class="comp-cell-mid">
                             <span class="diff-tag ${rateDiffClass}" style="opacity: 0.8">
                                ${rateDiff >= 0 ? "+" : ""}${rateDiff.toFixed(4)}%
                            </span>
                        </div>
                        <span class="comp-cell-right" style="font-size: 0.75rem; color: var(--text-overlay)">OI: ${formatVolume(osContract.totalOI_USD)}</span>
                    </div>
                    ` : ''}
                </div>
            `;
      }

      // ä¸»å‡½æ•°
      async function loadData() {
        try {
          // æ·»åŠ æ—¶é—´æˆ³é¿å…ç¼“å­˜
          const timestamp = Date.now();

          // åŠ è½½æ•°æ®
          const [hlRes, osRes] = await Promise.all([
            fetch(`hyperliquid_filtered.json?t=${timestamp}`),
            fetch(`ostium_filtered.json?t=${timestamp}`),
          ]);

          const hlData = await hlRes.json();
          const osData = await osRes.json();

          const hlContracts = hlData.contracts || [];
          const osContracts = osData.contracts || [];

          // æ›´æ–°è®¡æ•°
          document.getElementById(
            "hlCount"
          ).textContent = `${hlContracts.length} åˆçº¦`;
          document.getElementById(
            "osCount"
          ).textContent = `${osContracts.length} åˆçº¦`;

          // æ¸²æŸ“ Hyperliquid åˆ—è¡¨
          const hlList = document.getElementById("hlList");
          hlList.innerHTML = hlContracts.map(renderHLCard).join("");

          // æ¸²æŸ“ Ostium åˆ—è¡¨
          const osList = document.getElementById("osList");
          osList.innerHTML = osContracts.map(renderOSCard).join("");

          // æ‰¾å‡ºå…±åŒåˆçº¦
          const commonPairs = [];
          const hlMap = {};

          // æ„å»º Hyperliquid æ˜ å°„ï¼ˆæ”¯æŒå¸¦å‰ç¼€çš„åç§°å¦‚ xyz:GOLDï¼‰
          hlContracts.forEach((c) => {
            const coin = c.coin.includes(":") ? c.coin.split(":")[1] : c.coin;
            hlMap[coin.toUpperCase()] = c;
          });

          // æŸ¥æ‰¾åŒ¹é…
          osContracts.forEach((osContract) => {
            const osName = osContract.from.toUpperCase();
            const hlName = NAME_MAPPING[osName] || osName;

            if (hlMap[hlName]) {
              commonPairs.push({
                hl: hlMap[hlName],
                os: osContract,
                name: osName === hlName ? osName : `${osName} / ${hlName}`,
              });
            }
          });

          // æ¸²æŸ“å…±åŒåˆçº¦
          document.getElementById(
            "commonCount"
          ).textContent = `${commonPairs.length} å¯¹`;
          const commonList = document.getElementById("commonList");

          if (commonPairs.length > 0) {
            // æ’åºï¼šå°† NAME_MAPPING ä¸­çš„èµ„äº§æ”¾åœ¨æœ€å‰é¢
            const priorityAssets = Object.keys(NAME_MAPPING); // ['XAU', 'XAG', 'HG', 'NDX']
            commonPairs.sort((a, b) => {
              const aName = a.os.from.toUpperCase();
              const bName = b.os.from.toUpperCase();
              const aIsPriority = priorityAssets.includes(aName);
              const bIsPriority = priorityAssets.includes(bName);
              
              if (aIsPriority && !bIsPriority) return -1;
              if (!aIsPriority && bIsPriority) return 1;
              // å¦‚æœéƒ½æ˜¯ä¼˜å…ˆèµ„äº§ï¼ŒæŒ‰ priorityAssets ä¸­çš„é¡ºåºæ’åˆ—
              if (aIsPriority && bIsPriority) {
                return priorityAssets.indexOf(aName) - priorityAssets.indexOf(bName);
              }
              return 0; // å…¶ä»–èµ„äº§ä¿æŒåŸæœ‰é¡ºåº
            });
            
            commonList.innerHTML = commonPairs
              .map((p) => renderComparisonCard(p.hl, p.os, p.name))
              .join("");
          } else {
            commonList.innerHTML = `
                        <div class="empty-state">
                            <div class="emoji">ğŸ”</div>
                            <p>æš‚æ— å…±åŒåˆçº¦</p>
                            <p style="font-size: 0.8rem">è¯·ç¡®ä¿ä¸¤ä¸ªæ•°æ®æ–‡ä»¶éƒ½å·²æ›´æ–°</p>
                        </div>
                    `;
          }

          // æ›´æ–°æ—¶é—´ï¼ˆæ˜¾ç¤ºæ•°æ®æ–‡ä»¶çš„æ›´æ–°æ—¶é—´ï¼‰
          const dataTime =
            hlData.updated_at ||
            osData.updated_at ||
            new Date().toLocaleString("zh-CN");
          document.getElementById(
            "updateTime"
          ).textContent = `æ•°æ®æ›´æ–°: ${dataTime}`;

          return true;
        } catch (error) {
          console.error("åŠ è½½æ•°æ®å¤±è´¥:", error);
          document.getElementById("commonList").innerHTML = `
                    <div class="empty-state">
                        <div class="emoji">âš ï¸</div>
                        <p>åŠ è½½æ•°æ®å¤±è´¥</p>
                        <p style="font-size: 0.8rem">${error.message}</p>
                    </div>
                `;
          return false;
        }
      }

      // è‡ªåŠ¨åˆ·æ–°é…ç½®
      const AUTO_REFRESH_INTERVAL = 5000; // 5ç§’æ£€æŸ¥ä¸€æ¬¡
      let lastDataTime = null;

      // è‡ªåŠ¨åˆ·æ–°å‡½æ•°
      async function autoRefresh() {
        try {
          // è·å–æ•°æ®æ–‡ä»¶æ›´æ–°æ—¶é—´
          const res = await fetch(`hyperliquid_filtered.json?t=${Date.now()}`);
          const data = await res.json();

          // æ£€æŸ¥æ˜¯å¦æœ‰æ–°æ•°æ®
          if (data.updated_at && data.updated_at !== lastDataTime) {
            console.log(`[AutoRefresh] æ£€æµ‹åˆ°æ–°æ•°æ®: ${data.updated_at}`);
            lastDataTime = data.updated_at;
            await loadData();
          }
        } catch (e) {
          console.error("[AutoRefresh] æ£€æŸ¥æ›´æ–°å¤±è´¥:", e);
        }
      }

      // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
      loadData().then(() => {
        // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
        setInterval(autoRefresh, AUTO_REFRESH_INTERVAL);
        console.log(
          `[AutoRefresh] å·²å¯åŠ¨ï¼Œæ¯ ${AUTO_REFRESH_INTERVAL / 1000} ç§’æ£€æŸ¥æ›´æ–°`
        );
      });
    </script>
  </body>
</html>
